{
  "audit_summary": {
    "audit_timestamp": "2025-07-22T07:50:33.628625",
    "overall_status": "FAIL",
    "total_checks": 8,
    "passed_checks": 5,
    "failed_checks": 3,
    "skipped_checks": 0,
    "pass_rate": 62.5,
    "data_tables_analyzed": [
      "customer",
      "customer_device",
      "authentication_log",
      "bank_account",
      "face_template",
      "transaction"
    ],
    "total_records_analyzed": 177743
  },
  "check_results": {
    "null_missing_values": {
      "check_type": "null_missing_values",
      "status": "PASS",
      "issues": [],
      "summary": {
        "customer": {
          "total_records": 1999,
          "issues_count": 0,
          "failed_records": 0
        },
        "customer_device": {
          "total_records": 2287,
          "issues_count": 0,
          "failed_records": 0
        },
        "authentication_log": {
          "total_records": 97839,
          "issues_count": 0,
          "failed_records": 0
        },
        "bank_account": {
          "total_records": 2393,
          "issues_count": 0,
          "failed_records": 0
        },
        "face_template": {
          "total_records": 1699,
          "issues_count": 0,
          "failed_records": 0
        },
        "transaction": {
          "total_records": 71526,
          "issues_count": 0,
          "failed_records": 0
        }
      },
      "failed_rows": {},
      "requirement": "Null/missing values - Required fields must not be empty"
    },
    "uniqueness_constraints": {
      "check_type": "uniqueness_constraints",
      "status": "PASS",
      "issues": [],
      "summary": {
        "customer": {
          "total_records": 1999,
          "issues_count": 0,
          "failed_records": 0,
          "database_check_available": true
        },
        "customer_device": {
          "total_records": 2287,
          "issues_count": 0,
          "failed_records": 0,
          "database_check_available": true
        },
        "authentication_log": {
          "total_records": 97839,
          "issues_count": 0,
          "failed_records": 0,
          "database_check_available": true
        },
        "bank_account": {
          "total_records": 2393,
          "issues_count": 0,
          "failed_records": 0,
          "database_check_available": true
        },
        "face_template": {
          "total_records": 1699,
          "issues_count": 0,
          "failed_records": 0,
          "database_check_available": true
        },
        "transaction": {
          "total_records": 71526,
          "issues_count": 0,
          "failed_records": 0,
          "database_check_available": true
        }
      },
      "failed_rows": {},
      "requirement": "Uniqueness - Primary keys and unique fields must be unique across table"
    },
    "format_validation": {
      "check_type": "format_validation",
      "status": "FAIL",
      "issues": [
        {
          "table": "customer",
          "field": "id_passport_number",
          "invalid_count": 189,
          "total_count": 1999,
          "invalid_percentage": 9.45,
          "expected_patterns": [
            "cccd_number",
            "passport_number"
          ],
          "sample_invalid": [
            "E703277",
            "PY729151",
            "0177230893795",
            "4334842738139",
            "9832432642689"
          ],
          "failed_row_indices": [
            3,
            6,
            19,
            29,
            37,
            56,
            71,
            93,
            99,
            102,
            109,
            111,
            123,
            134,
            144,
            155,
            156,
            164,
            167,
            168,
            172,
            183,
            208,
            215,
            218,
            225,
            242,
            250,
            256,
            264,
            271,
            273,
            282,
            292,
            305,
            307,
            329,
            331,
            355,
            364,
            368,
            389,
            395,
            398,
            401,
            417,
            423,
            425,
            431,
            433,
            452,
            471,
            482,
            484,
            489,
            491,
            493,
            497,
            501,
            518,
            537,
            540,
            544,
            554,
            555,
            560,
            562,
            565,
            566,
            575,
            603,
            604,
            639,
            667,
            668,
            671,
            682,
            698,
            703,
            729,
            741,
            742,
            744,
            754,
            766,
            791,
            799,
            805,
            850,
            853,
            866,
            871,
            872,
            892,
            904,
            920,
            923,
            957,
            969,
            974,
            981,
            1003,
            1005,
            1023,
            1025,
            1034,
            1042,
            1046,
            1050,
            1060,
            1065,
            1066,
            1070,
            1071,
            1072,
            1094,
            1118,
            1119,
            1120,
            1123,
            1126,
            1139,
            1157,
            1164,
            1179,
            1188,
            1195,
            1207,
            1234,
            1237,
            1276,
            1281,
            1295,
            1311,
            1318,
            1322,
            1325,
            1328,
            1348,
            1349,
            1370,
            1380,
            1385,
            1404,
            1409,
            1430,
            1431,
            1460,
            1504,
            1509,
            1520,
            1541,
            1542,
            1543,
            1554,
            1574,
            1576,
            1595,
            1597,
            1604,
            1609,
            1629,
            1647,
            1660,
            1662,
            1673,
            1699,
            1705,
            1706,
            1726,
            1734,
            1769,
            1817,
            1824,
            1863,
            1867,
            1880,
            1892,
            1897,
            1898,
            1900,
            1901,
            1913,
            1935,
            1958,
            1960,
            1978,
            1979,
            1994
          ]
        },
        {
          "table": "customer",
          "field": "phone_number",
          "invalid_count": 218,
          "total_count": 1999,
          "invalid_percentage": 10.91,
          "expected_patterns": [
            "vietnamese_phone"
          ],
          "sample_invalid": [
            "037658859654",
            "03319855226",
            "05843455684",
            "05969933950",
            "08432901278"
          ],
          "failed_row_indices": [
            10,
            24,
            35,
            42,
            44,
            51,
            55,
            57,
            59,
            77,
            79,
            83,
            85,
            91,
            114,
            135,
            147,
            160,
            162,
            170,
            189,
            190,
            194,
            199,
            205,
            206,
            208,
            227,
            231,
            237,
            252,
            254,
            275,
            287,
            288,
            311,
            312,
            332,
            333,
            338,
            346,
            350,
            353,
            355,
            357,
            372,
            374,
            382,
            384,
            401,
            403,
            408,
            424,
            433,
            435,
            438,
            457,
            460,
            473,
            474,
            476,
            491,
            492,
            527,
            532,
            544,
            546,
            554,
            568,
            569,
            589,
            606,
            633,
            645,
            650,
            660,
            662,
            665,
            679,
            683,
            689,
            692,
            699,
            726,
            736,
            770,
            781,
            786,
            794,
            805,
            809,
            811,
            819,
            832,
            869,
            877,
            894,
            906,
            908,
            909,
            910,
            914,
            926,
            952,
            954,
            982,
            983,
            989,
            993,
            999,
            1006,
            1014,
            1015,
            1020,
            1023,
            1028,
            1035,
            1051,
            1060,
            1076,
            1078,
            1086,
            1092,
            1104,
            1120,
            1121,
            1122,
            1139,
            1161,
            1162,
            1166,
            1170,
            1174,
            1178,
            1183,
            1214,
            1232,
            1252,
            1253,
            1262,
            1267,
            1273,
            1292,
            1295,
            1296,
            1304,
            1307,
            1325,
            1344,
            1364,
            1372,
            1377,
            1399,
            1400,
            1401,
            1402,
            1412,
            1420,
            1432,
            1445,
            1448,
            1454,
            1457,
            1461,
            1479,
            1502,
            1509,
            1517,
            1531,
            1540,
            1556,
            1563,
            1584,
            1587,
            1595,
            1610,
            1626,
            1627,
            1635,
            1638,
            1639,
            1640,
            1662,
            1665,
            1683,
            1698,
            1708,
            1711,
            1723,
            1726,
            1736,
            1751,
            1759,
            1763,
            1785,
            1811,
            1820,
            1829,
            1837,
            1852,
            1858,
            1874,
            1880,
            1881,
            1883,
            1885,
            1890,
            1891,
            1894,
            1895,
            1904,
            1906,
            1908,
            1917,
            1919,
            1929,
            1953,
            1959
          ]
        }
      ],
      "summary": {
        "customer": {
          "total_records": 1999,
          "issues_count": 2,
          "failed_records": 388
        },
        "customer_device": {
          "total_records": 2287,
          "issues_count": 0,
          "failed_records": 0
        },
        "authentication_log": {
          "total_records": 97839,
          "issues_count": 0,
          "failed_records": 0
        },
        "bank_account": {
          "total_records": 2393,
          "issues_count": 0,
          "failed_records": 0
        },
        "face_template": {
          "total_records": 1699,
          "issues_count": 0,
          "failed_records": 0
        },
        "transaction": {
          "total_records": 71526,
          "issues_count": 0,
          "failed_records": 0
        }
      },
      "failed_rows": {
        "customer": [
          3,
          6,
          10,
          19,
          24,
          29,
          35,
          37,
          42,
          44,
          51,
          55,
          56,
          57,
          59,
          71,
          77,
          79,
          83,
          85,
          91,
          93,
          99,
          102,
          109,
          111,
          114,
          123,
          134,
          135,
          144,
          147,
          155,
          156,
          160,
          162,
          164,
          167,
          168,
          170,
          172,
          183,
          189,
          190,
          194,
          199,
          205,
          206,
          208,
          215,
          218,
          225,
          227,
          231,
          237,
          242,
          250,
          252,
          254,
          256,
          264,
          271,
          273,
          275,
          282,
          287,
          288,
          292,
          305,
          307,
          311,
          312,
          329,
          331,
          332,
          333,
          338,
          346,
          350,
          353,
          355,
          357,
          364,
          368,
          372,
          374,
          382,
          384,
          389,
          395,
          398,
          401,
          403,
          408,
          417,
          423,
          424,
          425,
          431,
          433,
          435,
          438,
          452,
          457,
          460,
          471,
          473,
          474,
          476,
          482,
          484,
          489,
          491,
          492,
          493,
          497,
          501,
          518,
          527,
          532,
          537,
          540,
          544,
          546,
          554,
          555,
          560,
          562,
          565,
          566,
          568,
          569,
          575,
          589,
          603,
          604,
          606,
          633,
          639,
          645,
          650,
          660,
          662,
          665,
          667,
          668,
          671,
          679,
          682,
          683,
          689,
          692,
          698,
          699,
          703,
          726,
          729,
          736,
          741,
          742,
          744,
          754,
          766,
          770,
          781,
          786,
          791,
          794,
          799,
          805,
          809,
          811,
          819,
          832,
          850,
          853,
          866,
          869,
          871,
          872,
          877,
          892,
          894,
          904,
          906,
          908,
          909,
          910,
          914,
          920,
          923,
          926,
          952,
          954,
          957,
          969,
          974,
          981,
          982,
          983,
          989,
          993,
          999,
          1003,
          1005,
          1006,
          1014,
          1015,
          1020,
          1023,
          1025,
          1028,
          1034,
          1035,
          1042,
          1046,
          1050,
          1051,
          1060,
          1065,
          1066,
          1070,
          1071,
          1072,
          1076,
          1078,
          1086,
          1092,
          1094,
          1104,
          1118,
          1119,
          1120,
          1121,
          1122,
          1123,
          1126,
          1139,
          1157,
          1161,
          1162,
          1164,
          1166,
          1170,
          1174,
          1178,
          1179,
          1183,
          1188,
          1195,
          1207,
          1214,
          1232,
          1234,
          1237,
          1252,
          1253,
          1262,
          1267,
          1273,
          1276,
          1281,
          1292,
          1295,
          1296,
          1304,
          1307,
          1311,
          1318,
          1322,
          1325,
          1328,
          1344,
          1348,
          1349,
          1364,
          1370,
          1372,
          1377,
          1380,
          1385,
          1399,
          1400,
          1401,
          1402,
          1404,
          1409,
          1412,
          1420,
          1430,
          1431,
          1432,
          1445,
          1448,
          1454,
          1457,
          1460,
          1461,
          1479,
          1502,
          1504,
          1509,
          1517,
          1520,
          1531,
          1540,
          1541,
          1542,
          1543,
          1554,
          1556,
          1563,
          1574,
          1576,
          1584,
          1587,
          1595,
          1597,
          1604,
          1609,
          1610,
          1626,
          1627,
          1629,
          1635,
          1638,
          1639,
          1640,
          1647,
          1660,
          1662,
          1665,
          1673,
          1683,
          1698,
          1699,
          1705,
          1706,
          1708,
          1711,
          1723,
          1726,
          1734,
          1736,
          1751,
          1759,
          1763,
          1769,
          1785,
          1811,
          1817,
          1820,
          1824,
          1829,
          1837,
          1852,
          1858,
          1863,
          1867,
          1874,
          1880,
          1881,
          1883,
          1885,
          1890,
          1891,
          1892,
          1894,
          1895,
          1897,
          1898,
          1900,
          1901,
          1904,
          1906,
          1908,
          1913,
          1917,
          1919,
          1929,
          1935,
          1953,
          1958,
          1959,
          1960,
          1978,
          1979,
          1994
        ]
      },
      "requirement": "Format/length validation - Data must match specified formats (phone numbers, emails, account numbers, etc.)"
    },
    "foreign_key_integrity": {
      "check_type": "foreign_key_integrity",
      "status": "PASS",
      "issues": [],
      "summary": {
        "total_relationships_checked": 7,
        "failed_relationships": 0,
        "total_failed_records": 0
      },
      "failed_rows": {},
      "requirement": "Foreign key integrity - All foreign key references must exist in parent tables"
    },
    "high_value_transaction_auth": {
      "check_type": "high_value_transaction_auth",
      "status": "PASS",
      "issues": [],
      "summary": {
        "total_transactions": 71526,
        "high_value_transactions": 9393,
        "violations": 0,
        "compliance_rate": 100.0
      },
      "failed_rows": {},
      "requirement": "Transactions more than 10M VND must use strong auth (biometric or OTP) - per 2345/QĐ-NHNN 2023"
    },
    "device_verification_requirement": {
      "check_type": "device_verification_requirement",
      "status": "FAIL",
      "issues": [
        {
          "rule": "Active devices must be trusted/verified",
          "untrusted_active_devices": 467,
          "total_active_devices": 1956,
          "violation_percentage": 20.42,
          "untrusted_by_device_type": {
            "Desktop": 41,
            "Mobile": 390,
            "Tablet": 36
          },
          "sample_violations": [
            {
              "device_identifier": "IMEI:353289101339744",
              "device_type": "Mobile",
              "customer_id": "64f0fc75-60b7-418b-83b9-c0cca4e2f81e"
            },
            {
              "device_identifier": "UUID:85bc4d11-e299-1b8a-88d7-a67992e9fd40",
              "device_type": "Mobile",
              "customer_id": "3fb4ab54-f6bd-454a-9c78-cb6b7a13a8f5"
            },
            {
              "device_identifier": "IMEI:867819056365577",
              "device_type": "Mobile",
              "customer_id": "8b82230c-13ae-4d77-a375-a7bcd96b6f38"
            },
            {
              "device_identifier": "IMEI:354045111107433",
              "device_type": "Mobile",
              "customer_id": "572b41a6-fb52-4af1-936f-9cb062840b20"
            },
            {
              "device_identifier": "UUID:85e73008-ed78-c0b6-8da7-e8be05049671",
              "device_type": "Mobile",
              "customer_id": "423d6cf7-e589-4783-82b9-c3c11d2f116d"
            }
          ],
          "failed_row_indices": [
            6,
            12,
            13,
            28,
            29,
            48,
            50,
            51,
            53,
            57,
            62,
            63,
            74,
            79,
            86,
            90,
            98,
            103,
            107,
            108,
            124,
            125,
            134,
            151,
            153,
            155,
            157,
            160,
            161,
            165,
            166,
            169,
            174,
            179,
            181,
            188,
            192,
            194,
            197,
            200,
            206,
            208,
            209,
            211,
            213,
            215,
            218,
            219,
            234,
            244,
            258,
            259,
            264,
            268,
            269,
            277,
            280,
            282,
            283,
            284,
            290,
            297,
            298,
            299,
            308,
            310,
            321,
            328,
            337,
            341,
            348,
            353,
            376,
            384,
            385,
            387,
            398,
            399,
            402,
            407,
            409,
            416,
            418,
            420,
            423,
            427,
            440,
            442,
            445,
            447,
            450,
            454,
            459,
            467,
            469,
            480,
            481,
            483,
            485,
            491,
            494,
            512,
            519,
            522,
            533,
            540,
            543,
            550,
            552,
            554,
            555,
            561,
            564,
            579,
            584,
            593,
            595,
            600,
            608,
            621,
            629,
            631,
            633,
            638,
            641,
            649,
            650,
            662,
            671,
            672,
            674,
            676,
            678,
            681,
            687,
            690,
            692,
            696,
            704,
            705,
            706,
            711,
            715,
            717,
            718,
            719,
            723,
            725,
            726,
            729,
            731,
            734,
            739,
            741,
            742,
            766,
            772,
            775,
            785,
            789,
            792,
            797,
            799,
            803,
            806,
            810,
            824,
            825,
            826,
            840,
            842,
            843,
            864,
            866,
            872,
            887,
            891,
            893,
            894,
            896,
            899,
            902,
            904,
            906,
            908,
            913,
            920,
            921,
            940,
            941,
            945,
            953,
            956,
            965,
            970,
            971,
            973,
            975,
            977,
            978,
            988,
            991,
            995,
            998,
            1012,
            1016,
            1025,
            1027,
            1031,
            1035,
            1037,
            1039,
            1042,
            1045,
            1046,
            1047,
            1048,
            1050,
            1052,
            1054,
            1059,
            1064,
            1065,
            1077,
            1079,
            1082,
            1083,
            1090,
            1093,
            1096,
            1103,
            1105,
            1110,
            1114,
            1116,
            1120,
            1135,
            1140,
            1152,
            1154,
            1157,
            1159,
            1167,
            1169,
            1180,
            1183,
            1189,
            1192,
            1193,
            1206,
            1212,
            1217,
            1219,
            1224,
            1225,
            1228,
            1229,
            1231,
            1234,
            1240,
            1245,
            1248,
            1258,
            1260,
            1264,
            1267,
            1271,
            1274,
            1283,
            1284,
            1290,
            1312,
            1313,
            1319,
            1325,
            1327,
            1338,
            1344,
            1345,
            1348,
            1352,
            1367,
            1375,
            1376,
            1381,
            1393,
            1395,
            1399,
            1403,
            1405,
            1410,
            1423,
            1426,
            1431,
            1437,
            1438,
            1444,
            1445,
            1446,
            1454,
            1462,
            1465,
            1466,
            1481,
            1489,
            1490,
            1494,
            1498,
            1501,
            1507,
            1515,
            1518,
            1528,
            1537,
            1543,
            1551,
            1552,
            1557,
            1566,
            1570,
            1577,
            1584,
            1585,
            1588,
            1592,
            1599,
            1602,
            1605,
            1606,
            1611,
            1614,
            1622,
            1623,
            1637,
            1639,
            1651,
            1652,
            1671,
            1675,
            1681,
            1686,
            1688,
            1690,
            1691,
            1696,
            1697,
            1707,
            1710,
            1728,
            1731,
            1741,
            1743,
            1745,
            1747,
            1757,
            1759,
            1760,
            1769,
            1770,
            1772,
            1775,
            1783,
            1800,
            1807,
            1811,
            1816,
            1823,
            1824,
            1828,
            1831,
            1832,
            1835,
            1842,
            1843,
            1852,
            1857,
            1861,
            1865,
            1870,
            1881,
            1887,
            1894,
            1896,
            1901,
            1905,
            1913,
            1915,
            1916,
            1926,
            1928,
            1930,
            1931,
            1934,
            1938,
            1948,
            1959,
            1963,
            1966,
            1970,
            1974,
            1977,
            1980,
            1986,
            1988,
            1990,
            1992,
            1995,
            2009,
            2011,
            2023,
            2024,
            2034,
            2036,
            2037,
            2042,
            2046,
            2049,
            2051,
            2055,
            2072,
            2084,
            2094,
            2096,
            2098,
            2101,
            2118,
            2119,
            2120,
            2125,
            2129,
            2134,
            2143,
            2148,
            2149,
            2158,
            2165,
            2174,
            2175,
            2178,
            2180,
            2184,
            2189,
            2191,
            2193,
            2194,
            2201,
            2203,
            2205,
            2209,
            2219,
            2220,
            2224,
            2229,
            2231,
            2234,
            2240,
            2242,
            2243,
            2245,
            2249,
            2254,
            2263,
            2269,
            2271,
            2272,
            2278,
            2283
          ]
        }
      ],
      "summary": {
        "total_devices": 2287,
        "active_devices": 1956,
        "trusted_devices": 1738,
        "untrusted_active_devices": 467,
        "trust_rate": 75.99
      },
      "failed_rows": {
        "customer_device": [
          6,
          12,
          13,
          28,
          29,
          48,
          50,
          51,
          53,
          57,
          62,
          63,
          74,
          79,
          86,
          90,
          98,
          103,
          107,
          108,
          124,
          125,
          134,
          151,
          153,
          155,
          157,
          160,
          161,
          165,
          166,
          169,
          174,
          179,
          181,
          188,
          192,
          194,
          197,
          200,
          206,
          208,
          209,
          211,
          213,
          215,
          218,
          219,
          234,
          244,
          258,
          259,
          264,
          268,
          269,
          277,
          280,
          282,
          283,
          284,
          290,
          297,
          298,
          299,
          308,
          310,
          321,
          328,
          337,
          341,
          348,
          353,
          376,
          384,
          385,
          387,
          398,
          399,
          402,
          407,
          409,
          416,
          418,
          420,
          423,
          427,
          440,
          442,
          445,
          447,
          450,
          454,
          459,
          467,
          469,
          480,
          481,
          483,
          485,
          491,
          494,
          512,
          519,
          522,
          533,
          540,
          543,
          550,
          552,
          554,
          555,
          561,
          564,
          579,
          584,
          593,
          595,
          600,
          608,
          621,
          629,
          631,
          633,
          638,
          641,
          649,
          650,
          662,
          671,
          672,
          674,
          676,
          678,
          681,
          687,
          690,
          692,
          696,
          704,
          705,
          706,
          711,
          715,
          717,
          718,
          719,
          723,
          725,
          726,
          729,
          731,
          734,
          739,
          741,
          742,
          766,
          772,
          775,
          785,
          789,
          792,
          797,
          799,
          803,
          806,
          810,
          824,
          825,
          826,
          840,
          842,
          843,
          864,
          866,
          872,
          887,
          891,
          893,
          894,
          896,
          899,
          902,
          904,
          906,
          908,
          913,
          920,
          921,
          940,
          941,
          945,
          953,
          956,
          965,
          970,
          971,
          973,
          975,
          977,
          978,
          988,
          991,
          995,
          998,
          1012,
          1016,
          1025,
          1027,
          1031,
          1035,
          1037,
          1039,
          1042,
          1045,
          1046,
          1047,
          1048,
          1050,
          1052,
          1054,
          1059,
          1064,
          1065,
          1077,
          1079,
          1082,
          1083,
          1090,
          1093,
          1096,
          1103,
          1105,
          1110,
          1114,
          1116,
          1120,
          1135,
          1140,
          1152,
          1154,
          1157,
          1159,
          1167,
          1169,
          1180,
          1183,
          1189,
          1192,
          1193,
          1206,
          1212,
          1217,
          1219,
          1224,
          1225,
          1228,
          1229,
          1231,
          1234,
          1240,
          1245,
          1248,
          1258,
          1260,
          1264,
          1267,
          1271,
          1274,
          1283,
          1284,
          1290,
          1312,
          1313,
          1319,
          1325,
          1327,
          1338,
          1344,
          1345,
          1348,
          1352,
          1367,
          1375,
          1376,
          1381,
          1393,
          1395,
          1399,
          1403,
          1405,
          1410,
          1423,
          1426,
          1431,
          1437,
          1438,
          1444,
          1445,
          1446,
          1454,
          1462,
          1465,
          1466,
          1481,
          1489,
          1490,
          1494,
          1498,
          1501,
          1507,
          1515,
          1518,
          1528,
          1537,
          1543,
          1551,
          1552,
          1557,
          1566,
          1570,
          1577,
          1584,
          1585,
          1588,
          1592,
          1599,
          1602,
          1605,
          1606,
          1611,
          1614,
          1622,
          1623,
          1637,
          1639,
          1651,
          1652,
          1671,
          1675,
          1681,
          1686,
          1688,
          1690,
          1691,
          1696,
          1697,
          1707,
          1710,
          1728,
          1731,
          1741,
          1743,
          1745,
          1747,
          1757,
          1759,
          1760,
          1769,
          1770,
          1772,
          1775,
          1783,
          1800,
          1807,
          1811,
          1816,
          1823,
          1824,
          1828,
          1831,
          1832,
          1835,
          1842,
          1843,
          1852,
          1857,
          1861,
          1865,
          1870,
          1881,
          1887,
          1894,
          1896,
          1901,
          1905,
          1913,
          1915,
          1916,
          1926,
          1928,
          1930,
          1931,
          1934,
          1938,
          1948,
          1959,
          1963,
          1966,
          1970,
          1974,
          1977,
          1980,
          1986,
          1988,
          1990,
          1992,
          1995,
          2009,
          2011,
          2023,
          2024,
          2034,
          2036,
          2037,
          2042,
          2046,
          2049,
          2051,
          2055,
          2072,
          2084,
          2094,
          2096,
          2098,
          2101,
          2118,
          2119,
          2120,
          2125,
          2129,
          2134,
          2143,
          2148,
          2149,
          2158,
          2165,
          2174,
          2175,
          2178,
          2180,
          2184,
          2189,
          2191,
          2193,
          2194,
          2201,
          2203,
          2205,
          2209,
          2219,
          2220,
          2224,
          2229,
          2231,
          2234,
          2240,
          2242,
          2243,
          2245,
          2249,
          2254,
          2263,
          2269,
          2271,
          2272,
          2278,
          2283
        ]
      },
      "requirement": "Device must be verified if new or untrusted - Active devices must be trusted/verified"
    },
    "daily_transaction_limit_auth": {
      "check_type": "daily_transaction_limit_auth",
      "status": "FAIL",
      "issues": [
        {
          "rule": "Daily transactions >= 20M VND must have at least one strong authentication (PIN_OTP or PIN_OTP_Biometric)",
          "violation_count": 4,
          "total_high_daily_volume_cases": 4153,
          "violation_percentage": 0.1,
          "sample_violations": [
            {
              "customer_id": "0d9766c0-18c2-4130-bfe7-80b1a94b58a3",
              "transaction_date": "2025-06-27",
              "total_amount": 20790000.0,
              "transaction_count": 3,
              "auth_methods_used": [
                "PIN"
              ]
            },
            {
              "customer_id": "3324573c-ded1-48df-98ee-e712e7be7c1a",
              "transaction_date": "2025-07-10",
              "total_amount": 20050000.0,
              "transaction_count": 3,
              "auth_methods_used": [
                "PIN"
              ]
            },
            {
              "customer_id": "66221a64-0e1b-4864-a2b2-c6067212af08",
              "transaction_date": "2025-07-10",
              "total_amount": 24050000.0,
              "transaction_count": 3,
              "auth_methods_used": [
                "PIN"
              ]
            },
            {
              "customer_id": "a7aafad5-f4c7-4f13-ba23-2ac23f4bde93",
              "transaction_date": "2025-07-14",
              "total_amount": 22050000.0,
              "transaction_count": 6,
              "auth_methods_used": [
                "PIN"
              ]
            }
          ]
        }
      ],
      "summary": {
        "total_customer_days_analyzed": 33818,
        "high_volume_days": 4153,
        "violation_days": 4,
        "compliance_rate": 99.9
      },
      "failed_rows": {},
      "requirement": "Total transaction amount per customer more than 20M VND in a day must have at least one strong auth method - per 2345/QĐ-NHNN 2023"
    },
    "transaction_type_constraints": {
      "check_type": "transaction_type_constraints",
      "status": "PASS",
      "issues": [],
      "summary": {
        "total_transactions": 71526,
        "internal_transfers": 32307,
        "external_transfers": 24846,
        "bill_payments": 14373,
        "constraint_violations": 0
      },
      "failed_rows": {},
      "requirement": "Transaction type constraints - Transaction-specific field requirements must be satisfied based on transaction type"
    }
  },
  "cleaning_summary": {
    "customer": {
      "original_count": 1999,
      "removed_count": 388,
      "final_count": 1611,
      "cleaned_percentage": 80.59,
      "final_count_after_fk_cleanup": 1611,
      "total_removed": 388,
      "final_cleaned_percentage": 80.59
    },
    "customer_device": {
      "original_count": 2287,
      "removed_count": 467,
      "final_count": 1820,
      "cleaned_percentage": 79.58,
      "final_count_after_fk_cleanup": 1467,
      "total_removed": 820,
      "final_cleaned_percentage": 64.15
    },
    "authentication_log": {
      "original_count": 97839,
      "removed_count": 0,
      "final_count": 97839,
      "cleaned_percentage": 100.0,
      "final_count_after_fk_cleanup": 63376,
      "total_removed": 34463,
      "final_cleaned_percentage": 64.78
    },
    "bank_account": {
      "original_count": 2393,
      "removed_count": 0,
      "final_count": 2393,
      "cleaned_percentage": 100.0,
      "final_count_after_fk_cleanup": 1929,
      "total_removed": 464,
      "final_cleaned_percentage": 80.61
    },
    "face_template": {
      "original_count": 1699,
      "removed_count": 0,
      "final_count": 1699,
      "cleaned_percentage": 100.0,
      "final_count_after_fk_cleanup": 1367,
      "total_removed": 332,
      "final_cleaned_percentage": 80.46
    },
    "transaction": {
      "original_count": 71526,
      "removed_count": 0,
      "final_count": 71526,
      "cleaned_percentage": 100.0,
      "final_count_after_fk_cleanup": 57831,
      "total_removed": 13695,
      "final_cleaned_percentage": 80.85
    }
  },
  "failed_rows_aggregated": {
    "customer": [
      3,
      6,
      10,
      19,
      24,
      29,
      35,
      37,
      42,
      44,
      51,
      55,
      56,
      57,
      59,
      71,
      77,
      79,
      83,
      85,
      91,
      93,
      99,
      102,
      109,
      111,
      114,
      123,
      134,
      135,
      144,
      147,
      155,
      156,
      160,
      162,
      164,
      167,
      168,
      170,
      172,
      183,
      189,
      190,
      194,
      199,
      205,
      206,
      208,
      215,
      218,
      225,
      227,
      231,
      237,
      242,
      250,
      252,
      254,
      256,
      264,
      271,
      273,
      275,
      282,
      287,
      288,
      292,
      305,
      307,
      311,
      312,
      329,
      331,
      332,
      333,
      338,
      346,
      350,
      353,
      355,
      357,
      364,
      368,
      372,
      374,
      382,
      384,
      389,
      395,
      398,
      401,
      403,
      408,
      417,
      423,
      424,
      425,
      431,
      433,
      435,
      438,
      452,
      457,
      460,
      471,
      473,
      474,
      476,
      482,
      484,
      489,
      491,
      492,
      493,
      497,
      501,
      518,
      527,
      532,
      537,
      540,
      544,
      546,
      554,
      555,
      560,
      562,
      565,
      566,
      568,
      569,
      575,
      589,
      603,
      604,
      606,
      633,
      639,
      645,
      650,
      660,
      662,
      665,
      667,
      668,
      671,
      679,
      682,
      683,
      689,
      692,
      698,
      699,
      703,
      726,
      729,
      736,
      741,
      742,
      744,
      754,
      766,
      770,
      781,
      786,
      791,
      794,
      799,
      805,
      809,
      811,
      819,
      832,
      850,
      853,
      866,
      869,
      871,
      872,
      877,
      892,
      894,
      904,
      906,
      908,
      909,
      910,
      914,
      920,
      923,
      926,
      952,
      954,
      957,
      969,
      974,
      981,
      982,
      983,
      989,
      993,
      999,
      1003,
      1005,
      1006,
      1014,
      1015,
      1020,
      1023,
      1025,
      1028,
      1034,
      1035,
      1042,
      1046,
      1050,
      1051,
      1060,
      1065,
      1066,
      1070,
      1071,
      1072,
      1076,
      1078,
      1086,
      1092,
      1094,
      1104,
      1118,
      1119,
      1120,
      1121,
      1122,
      1123,
      1126,
      1139,
      1157,
      1161,
      1162,
      1164,
      1166,
      1170,
      1174,
      1178,
      1179,
      1183,
      1188,
      1195,
      1207,
      1214,
      1232,
      1234,
      1237,
      1252,
      1253,
      1262,
      1267,
      1273,
      1276,
      1281,
      1292,
      1295,
      1296,
      1304,
      1307,
      1311,
      1318,
      1322,
      1325,
      1328,
      1344,
      1348,
      1349,
      1364,
      1370,
      1372,
      1377,
      1380,
      1385,
      1399,
      1400,
      1401,
      1402,
      1404,
      1409,
      1412,
      1420,
      1430,
      1431,
      1432,
      1445,
      1448,
      1454,
      1457,
      1460,
      1461,
      1479,
      1502,
      1504,
      1509,
      1517,
      1520,
      1531,
      1540,
      1541,
      1542,
      1543,
      1554,
      1556,
      1563,
      1574,
      1576,
      1584,
      1587,
      1595,
      1597,
      1604,
      1609,
      1610,
      1626,
      1627,
      1629,
      1635,
      1638,
      1639,
      1640,
      1647,
      1660,
      1662,
      1665,
      1673,
      1683,
      1698,
      1699,
      1705,
      1706,
      1708,
      1711,
      1723,
      1726,
      1734,
      1736,
      1751,
      1759,
      1763,
      1769,
      1785,
      1811,
      1817,
      1820,
      1824,
      1829,
      1837,
      1852,
      1858,
      1863,
      1867,
      1874,
      1880,
      1881,
      1883,
      1885,
      1890,
      1891,
      1892,
      1894,
      1895,
      1897,
      1898,
      1900,
      1901,
      1904,
      1906,
      1908,
      1913,
      1917,
      1919,
      1929,
      1935,
      1953,
      1958,
      1959,
      1960,
      1978,
      1979,
      1994
    ],
    "customer_device": [
      6,
      12,
      13,
      28,
      29,
      48,
      50,
      51,
      53,
      57,
      62,
      63,
      74,
      79,
      86,
      90,
      98,
      103,
      107,
      108,
      124,
      125,
      134,
      151,
      153,
      155,
      157,
      160,
      161,
      165,
      166,
      169,
      174,
      179,
      181,
      188,
      192,
      194,
      197,
      200,
      206,
      208,
      209,
      211,
      213,
      215,
      218,
      219,
      234,
      244,
      258,
      259,
      264,
      268,
      269,
      277,
      280,
      282,
      283,
      284,
      290,
      297,
      298,
      299,
      308,
      310,
      321,
      328,
      337,
      341,
      348,
      353,
      376,
      384,
      385,
      387,
      398,
      399,
      402,
      407,
      409,
      416,
      418,
      420,
      423,
      427,
      440,
      442,
      445,
      447,
      450,
      454,
      459,
      467,
      469,
      480,
      481,
      483,
      485,
      491,
      494,
      512,
      519,
      522,
      533,
      540,
      543,
      550,
      552,
      554,
      555,
      561,
      564,
      579,
      584,
      593,
      595,
      600,
      608,
      621,
      629,
      631,
      633,
      638,
      641,
      649,
      650,
      662,
      671,
      672,
      674,
      676,
      678,
      681,
      687,
      690,
      692,
      696,
      704,
      705,
      706,
      711,
      715,
      717,
      718,
      719,
      723,
      725,
      726,
      729,
      731,
      734,
      739,
      741,
      742,
      766,
      772,
      775,
      785,
      789,
      792,
      797,
      799,
      803,
      806,
      810,
      824,
      825,
      826,
      840,
      842,
      843,
      864,
      866,
      872,
      887,
      891,
      893,
      894,
      896,
      899,
      902,
      904,
      906,
      908,
      913,
      920,
      921,
      940,
      941,
      945,
      953,
      956,
      965,
      970,
      971,
      973,
      975,
      977,
      978,
      988,
      991,
      995,
      998,
      1012,
      1016,
      1025,
      1027,
      1031,
      1035,
      1037,
      1039,
      1042,
      1045,
      1046,
      1047,
      1048,
      1050,
      1052,
      1054,
      1059,
      1064,
      1065,
      1077,
      1079,
      1082,
      1083,
      1090,
      1093,
      1096,
      1103,
      1105,
      1110,
      1114,
      1116,
      1120,
      1135,
      1140,
      1152,
      1154,
      1157,
      1159,
      1167,
      1169,
      1180,
      1183,
      1189,
      1192,
      1193,
      1206,
      1212,
      1217,
      1219,
      1224,
      1225,
      1228,
      1229,
      1231,
      1234,
      1240,
      1245,
      1248,
      1258,
      1260,
      1264,
      1267,
      1271,
      1274,
      1283,
      1284,
      1290,
      1312,
      1313,
      1319,
      1325,
      1327,
      1338,
      1344,
      1345,
      1348,
      1352,
      1367,
      1375,
      1376,
      1381,
      1393,
      1395,
      1399,
      1403,
      1405,
      1410,
      1423,
      1426,
      1431,
      1437,
      1438,
      1444,
      1445,
      1446,
      1454,
      1462,
      1465,
      1466,
      1481,
      1489,
      1490,
      1494,
      1498,
      1501,
      1507,
      1515,
      1518,
      1528,
      1537,
      1543,
      1551,
      1552,
      1557,
      1566,
      1570,
      1577,
      1584,
      1585,
      1588,
      1592,
      1599,
      1602,
      1605,
      1606,
      1611,
      1614,
      1622,
      1623,
      1637,
      1639,
      1651,
      1652,
      1671,
      1675,
      1681,
      1686,
      1688,
      1690,
      1691,
      1696,
      1697,
      1707,
      1710,
      1728,
      1731,
      1741,
      1743,
      1745,
      1747,
      1757,
      1759,
      1760,
      1769,
      1770,
      1772,
      1775,
      1783,
      1800,
      1807,
      1811,
      1816,
      1823,
      1824,
      1828,
      1831,
      1832,
      1835,
      1842,
      1843,
      1852,
      1857,
      1861,
      1865,
      1870,
      1881,
      1887,
      1894,
      1896,
      1901,
      1905,
      1913,
      1915,
      1916,
      1926,
      1928,
      1930,
      1931,
      1934,
      1938,
      1948,
      1959,
      1963,
      1966,
      1970,
      1974,
      1977,
      1980,
      1986,
      1988,
      1990,
      1992,
      1995,
      2009,
      2011,
      2023,
      2024,
      2034,
      2036,
      2037,
      2042,
      2046,
      2049,
      2051,
      2055,
      2072,
      2084,
      2094,
      2096,
      2098,
      2101,
      2118,
      2119,
      2120,
      2125,
      2129,
      2134,
      2143,
      2148,
      2149,
      2158,
      2165,
      2174,
      2175,
      2178,
      2180,
      2184,
      2189,
      2191,
      2193,
      2194,
      2201,
      2203,
      2205,
      2209,
      2219,
      2220,
      2224,
      2229,
      2231,
      2234,
      2240,
      2242,
      2243,
      2245,
      2249,
      2254,
      2263,
      2269,
      2271,
      2272,
      2278,
      2283
    ]
  }
}