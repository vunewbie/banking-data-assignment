{
  "audit_summary": {
    "audit_timestamp": "2025-07-22T08:45:44.143222",
    "overall_status": "FAIL",
    "total_checks": 8,
    "passed_checks": 5,
    "failed_checks": 3,
    "skipped_checks": 0,
    "pass_rate": 62.5,
    "data_tables_analyzed": [
      "customer",
      "customer_device",
      "authentication_log",
      "bank_account",
      "face_template",
      "transaction"
    ],
    "total_records_analyzed": 174774
  },
  "check_results": {
    "null_missing_values": {
      "check_type": "null_missing_values",
      "status": "PASS",
      "issues": [],
      "summary": {
        "customer": {
          "total_records": 1998,
          "issues_count": 0,
          "failed_records": 0
        },
        "customer_device": {
          "total_records": 2292,
          "issues_count": 0,
          "failed_records": 0
        },
        "authentication_log": {
          "total_records": 96091,
          "issues_count": 0,
          "failed_records": 0
        },
        "bank_account": {
          "total_records": 2371,
          "issues_count": 0,
          "failed_records": 0
        },
        "face_template": {
          "total_records": 1701,
          "issues_count": 0,
          "failed_records": 0
        },
        "transaction": {
          "total_records": 70321,
          "issues_count": 0,
          "failed_records": 0
        }
      },
      "failed_rows": {},
      "requirement": "Null/missing values - Required fields must not be empty"
    },
    "uniqueness_constraints": {
      "check_type": "uniqueness_constraints",
      "status": "PASS",
      "issues": [],
      "summary": {
        "customer": {
          "total_records": 1998,
          "issues_count": 0,
          "failed_records": 0,
          "database_check_available": true
        },
        "customer_device": {
          "total_records": 2292,
          "issues_count": 0,
          "failed_records": 0,
          "database_check_available": true
        },
        "authentication_log": {
          "total_records": 96091,
          "issues_count": 0,
          "failed_records": 0,
          "database_check_available": true
        },
        "bank_account": {
          "total_records": 2371,
          "issues_count": 0,
          "failed_records": 0,
          "database_check_available": true
        },
        "face_template": {
          "total_records": 1701,
          "issues_count": 0,
          "failed_records": 0,
          "database_check_available": true
        },
        "transaction": {
          "total_records": 70321,
          "issues_count": 0,
          "failed_records": 0,
          "database_check_available": true
        }
      },
      "failed_rows": {},
      "requirement": "Uniqueness - Primary keys and unique fields must be unique across table"
    },
    "format_validation": {
      "check_type": "format_validation",
      "status": "FAIL",
      "issues": [
        {
          "table": "customer",
          "field": "id_passport_number",
          "invalid_count": 163,
          "total_count": 1998,
          "invalid_percentage": 8.16,
          "expected_patterns": [
            "cccd_number",
            "passport_number"
          ],
          "sample_invalid": [
            "59017264110085",
            "AY254210",
            "K859440",
            "0666315607",
            "78348506367"
          ],
          "failed_row_indices": [
            2,
            6,
            8,
            14,
            40,
            52,
            57,
            58,
            76,
            84,
            136,
            151,
            168,
            169,
            172,
            174,
            180,
            181,
            184,
            191,
            193,
            214,
            215,
            220,
            235,
            249,
            256,
            275,
            282,
            286,
            287,
            304,
            308,
            317,
            347,
            372,
            377,
            389,
            432,
            469,
            482,
            510,
            527,
            542,
            585,
            586,
            594,
            604,
            605,
            609,
            622,
            626,
            673,
            682,
            707,
            709,
            715,
            718,
            721,
            733,
            734,
            742,
            758,
            760,
            766,
            772,
            774,
            777,
            785,
            788,
            795,
            809,
            816,
            850,
            871,
            873,
            895,
            930,
            937,
            967,
            970,
            984,
            993,
            1020,
            1025,
            1065,
            1092,
            1099,
            1100,
            1103,
            1106,
            1110,
            1112,
            1117,
            1122,
            1145,
            1152,
            1157,
            1160,
            1176,
            1177,
            1190,
            1217,
            1227,
            1231,
            1238,
            1270,
            1273,
            1277,
            1317,
            1327,
            1330,
            1347,
            1353,
            1365,
            1388,
            1393,
            1413,
            1425,
            1428,
            1452,
            1458,
            1459,
            1472,
            1478,
            1480,
            1505,
            1517,
            1524,
            1533,
            1566,
            1577,
            1606,
            1611,
            1612,
            1635,
            1653,
            1673,
            1692,
            1698,
            1704,
            1721,
            1737,
            1751,
            1756,
            1770,
            1791,
            1792,
            1808,
            1819,
            1821,
            1836,
            1878,
            1921,
            1923,
            1924,
            1928,
            1933,
            1941,
            1955,
            1968,
            1975,
            1984
          ]
        },
        {
          "table": "customer",
          "field": "phone_number",
          "invalid_count": 224,
          "total_count": 1998,
          "invalid_percentage": 11.21,
          "expected_patterns": [
            "vietnamese_phone"
          ],
          "sample_invalid": [
            "09264290",
            "09307030",
            "082173899218",
            "08555242",
            "08859599516"
          ],
          "failed_row_indices": [
            4,
            33,
            39,
            41,
            43,
            44,
            55,
            57,
            70,
            83,
            94,
            101,
            109,
            115,
            127,
            131,
            132,
            145,
            156,
            159,
            165,
            188,
            195,
            215,
            219,
            220,
            233,
            239,
            245,
            249,
            252,
            254,
            255,
            262,
            275,
            281,
            284,
            289,
            291,
            295,
            312,
            315,
            316,
            350,
            351,
            353,
            354,
            366,
            374,
            398,
            419,
            426,
            449,
            452,
            458,
            469,
            480,
            489,
            508,
            520,
            522,
            530,
            541,
            542,
            563,
            577,
            613,
            624,
            646,
            664,
            683,
            689,
            725,
            731,
            749,
            770,
            778,
            781,
            787,
            796,
            802,
            807,
            815,
            825,
            830,
            833,
            844,
            852,
            860,
            881,
            884,
            885,
            892,
            893,
            895,
            906,
            907,
            914,
            918,
            919,
            932,
            966,
            993,
            997,
            1000,
            1001,
            1002,
            1004,
            1005,
            1007,
            1015,
            1028,
            1033,
            1035,
            1038,
            1043,
            1049,
            1050,
            1063,
            1075,
            1079,
            1083,
            1085,
            1095,
            1099,
            1106,
            1124,
            1136,
            1149,
            1156,
            1174,
            1198,
            1206,
            1210,
            1218,
            1226,
            1236,
            1242,
            1249,
            1252,
            1254,
            1256,
            1276,
            1283,
            1297,
            1319,
            1320,
            1323,
            1329,
            1332,
            1336,
            1337,
            1342,
            1344,
            1351,
            1356,
            1359,
            1366,
            1392,
            1415,
            1417,
            1432,
            1441,
            1442,
            1443,
            1469,
            1473,
            1483,
            1488,
            1489,
            1510,
            1524,
            1529,
            1577,
            1587,
            1593,
            1596,
            1599,
            1601,
            1602,
            1612,
            1626,
            1633,
            1645,
            1654,
            1656,
            1658,
            1664,
            1686,
            1690,
            1691,
            1692,
            1695,
            1697,
            1699,
            1713,
            1714,
            1725,
            1727,
            1741,
            1751,
            1762,
            1774,
            1804,
            1815,
            1816,
            1823,
            1824,
            1825,
            1839,
            1859,
            1861,
            1875,
            1886,
            1892,
            1902,
            1904,
            1915,
            1936,
            1957,
            1974,
            1977,
            1980,
            1988
          ]
        }
      ],
      "summary": {
        "customer": {
          "total_records": 1998,
          "issues_count": 2,
          "failed_records": 371
        },
        "customer_device": {
          "total_records": 2292,
          "issues_count": 0,
          "failed_records": 0
        },
        "authentication_log": {
          "total_records": 96091,
          "issues_count": 0,
          "failed_records": 0
        },
        "bank_account": {
          "total_records": 2371,
          "issues_count": 0,
          "failed_records": 0
        },
        "face_template": {
          "total_records": 1701,
          "issues_count": 0,
          "failed_records": 0
        },
        "transaction": {
          "total_records": 70321,
          "issues_count": 0,
          "failed_records": 0
        }
      },
      "failed_rows": {
        "customer": [
          2,
          4,
          6,
          8,
          14,
          33,
          39,
          40,
          41,
          43,
          44,
          52,
          55,
          57,
          58,
          70,
          76,
          83,
          84,
          94,
          101,
          109,
          115,
          127,
          131,
          132,
          136,
          145,
          151,
          156,
          159,
          165,
          168,
          169,
          172,
          174,
          180,
          181,
          184,
          188,
          191,
          193,
          195,
          214,
          215,
          219,
          220,
          233,
          235,
          239,
          245,
          249,
          252,
          254,
          255,
          256,
          262,
          275,
          281,
          282,
          284,
          286,
          287,
          289,
          291,
          295,
          304,
          308,
          312,
          315,
          316,
          317,
          347,
          350,
          351,
          353,
          354,
          366,
          372,
          374,
          377,
          389,
          398,
          419,
          426,
          432,
          449,
          452,
          458,
          469,
          480,
          482,
          489,
          508,
          510,
          520,
          522,
          527,
          530,
          541,
          542,
          563,
          577,
          585,
          586,
          594,
          604,
          605,
          609,
          613,
          622,
          624,
          626,
          646,
          664,
          673,
          682,
          683,
          689,
          707,
          709,
          715,
          718,
          721,
          725,
          731,
          733,
          734,
          742,
          749,
          758,
          760,
          766,
          770,
          772,
          774,
          777,
          778,
          781,
          785,
          787,
          788,
          795,
          796,
          802,
          807,
          809,
          815,
          816,
          825,
          830,
          833,
          844,
          850,
          852,
          860,
          871,
          873,
          881,
          884,
          885,
          892,
          893,
          895,
          906,
          907,
          914,
          918,
          919,
          930,
          932,
          937,
          966,
          967,
          970,
          984,
          993,
          997,
          1000,
          1001,
          1002,
          1004,
          1005,
          1007,
          1015,
          1020,
          1025,
          1028,
          1033,
          1035,
          1038,
          1043,
          1049,
          1050,
          1063,
          1065,
          1075,
          1079,
          1083,
          1085,
          1092,
          1095,
          1099,
          1100,
          1103,
          1106,
          1110,
          1112,
          1117,
          1122,
          1124,
          1136,
          1145,
          1149,
          1152,
          1156,
          1157,
          1160,
          1174,
          1176,
          1177,
          1190,
          1198,
          1206,
          1210,
          1217,
          1218,
          1226,
          1227,
          1231,
          1236,
          1238,
          1242,
          1249,
          1252,
          1254,
          1256,
          1270,
          1273,
          1276,
          1277,
          1283,
          1297,
          1317,
          1319,
          1320,
          1323,
          1327,
          1329,
          1330,
          1332,
          1336,
          1337,
          1342,
          1344,
          1347,
          1351,
          1353,
          1356,
          1359,
          1365,
          1366,
          1388,
          1392,
          1393,
          1413,
          1415,
          1417,
          1425,
          1428,
          1432,
          1441,
          1442,
          1443,
          1452,
          1458,
          1459,
          1469,
          1472,
          1473,
          1478,
          1480,
          1483,
          1488,
          1489,
          1505,
          1510,
          1517,
          1524,
          1529,
          1533,
          1566,
          1577,
          1587,
          1593,
          1596,
          1599,
          1601,
          1602,
          1606,
          1611,
          1612,
          1626,
          1633,
          1635,
          1645,
          1653,
          1654,
          1656,
          1658,
          1664,
          1673,
          1686,
          1690,
          1691,
          1692,
          1695,
          1697,
          1698,
          1699,
          1704,
          1713,
          1714,
          1721,
          1725,
          1727,
          1737,
          1741,
          1751,
          1756,
          1762,
          1770,
          1774,
          1791,
          1792,
          1804,
          1808,
          1815,
          1816,
          1819,
          1821,
          1823,
          1824,
          1825,
          1836,
          1839,
          1859,
          1861,
          1875,
          1878,
          1886,
          1892,
          1902,
          1904,
          1915,
          1921,
          1923,
          1924,
          1928,
          1933,
          1936,
          1941,
          1955,
          1957,
          1968,
          1974,
          1975,
          1977,
          1980,
          1984,
          1988
        ]
      },
      "requirement": "Format/length validation - Data must match specified formats (phone numbers, emails, account numbers, etc.)"
    },
    "foreign_key_integrity": {
      "check_type": "foreign_key_integrity",
      "status": "PASS",
      "issues": [],
      "summary": {
        "total_relationships_checked": 7,
        "failed_relationships": 0,
        "total_failed_records": 0
      },
      "failed_rows": {},
      "requirement": "Foreign key integrity - All foreign key references must exist in parent tables"
    },
    "high_value_transaction_auth": {
      "check_type": "high_value_transaction_auth",
      "status": "PASS",
      "issues": [],
      "summary": {
        "total_transactions": 70321,
        "high_value_transactions": 9082,
        "violations": 0,
        "compliance_rate": 100.0
      },
      "failed_rows": {},
      "requirement": "Transactions more than 10M VND must use strong auth (biometric or OTP) - per 2345/QĐ-NHNN 2023"
    },
    "device_verification_requirement": {
      "check_type": "device_verification_requirement",
      "status": "FAIL",
      "issues": [
        {
          "rule": "Active devices must be trusted/verified",
          "untrusted_active_devices": 463,
          "total_active_devices": 1923,
          "violation_percentage": 20.2,
          "untrusted_by_device_type": {
            "Desktop": 41,
            "Mobile": 379,
            "Tablet": 43
          },
          "sample_violations": [
            {
              "device_identifier": "IMEI:358755101359266",
              "device_type": "Mobile",
              "customer_id": "d8b5f3b8-d780-46d9-92e7-3dde761fbc2e"
            },
            {
              "device_identifier": "MAC:CA:AF:07:C2:90:5A",
              "device_type": "Desktop",
              "customer_id": "b170577b-e210-4fc6-89d0-03b9c9ad6e9b"
            },
            {
              "device_identifier": "UUID:b9890791-eefb-cef3-5d46-fad8656b5718",
              "device_type": "Tablet",
              "customer_id": "bf26675e-65e1-4472-9a4a-8947bd3420b3"
            },
            {
              "device_identifier": "IMEI:353289102240788",
              "device_type": "Mobile",
              "customer_id": "eba89b93-2886-4b9f-8a4f-a1596ea45c22"
            },
            {
              "device_identifier": "IMEI:867819052092799",
              "device_type": "Mobile",
              "customer_id": "70a6704e-e1ae-47b0-bcfc-b5c353ddec06"
            }
          ],
          "failed_row_indices": [
            8,
            11,
            15,
            17,
            27,
            35,
            37,
            40,
            43,
            46,
            47,
            52,
            53,
            57,
            66,
            68,
            84,
            85,
            87,
            92,
            115,
            121,
            123,
            125,
            130,
            133,
            145,
            148,
            149,
            150,
            159,
            167,
            172,
            175,
            176,
            184,
            190,
            200,
            201,
            208,
            210,
            226,
            228,
            229,
            231,
            247,
            261,
            262,
            266,
            267,
            293,
            297,
            314,
            315,
            317,
            335,
            339,
            343,
            350,
            353,
            359,
            364,
            369,
            371,
            373,
            395,
            401,
            407,
            410,
            411,
            412,
            413,
            425,
            431,
            432,
            435,
            445,
            447,
            448,
            451,
            453,
            464,
            466,
            469,
            478,
            483,
            484,
            486,
            488,
            491,
            498,
            502,
            504,
            505,
            520,
            525,
            540,
            542,
            544,
            549,
            562,
            565,
            567,
            572,
            577,
            585,
            587,
            589,
            592,
            594,
            598,
            606,
            607,
            609,
            612,
            615,
            628,
            629,
            631,
            632,
            636,
            640,
            641,
            649,
            661,
            666,
            675,
            689,
            692,
            693,
            696,
            704,
            713,
            728,
            730,
            733,
            734,
            737,
            741,
            742,
            744,
            745,
            746,
            750,
            752,
            775,
            778,
            785,
            788,
            792,
            794,
            800,
            802,
            809,
            818,
            819,
            821,
            827,
            828,
            839,
            843,
            845,
            850,
            865,
            871,
            875,
            879,
            880,
            889,
            892,
            901,
            904,
            905,
            908,
            911,
            919,
            921,
            926,
            930,
            931,
            936,
            942,
            943,
            949,
            958,
            959,
            963,
            968,
            972,
            980,
            988,
            994,
            995,
            997,
            1004,
            1005,
            1006,
            1010,
            1013,
            1014,
            1023,
            1024,
            1030,
            1032,
            1033,
            1036,
            1037,
            1041,
            1043,
            1050,
            1052,
            1056,
            1079,
            1083,
            1085,
            1089,
            1090,
            1092,
            1094,
            1095,
            1104,
            1109,
            1110,
            1111,
            1116,
            1118,
            1120,
            1124,
            1125,
            1134,
            1135,
            1136,
            1144,
            1147,
            1148,
            1149,
            1157,
            1165,
            1169,
            1176,
            1184,
            1185,
            1190,
            1191,
            1192,
            1194,
            1198,
            1207,
            1208,
            1214,
            1219,
            1220,
            1228,
            1235,
            1236,
            1239,
            1244,
            1245,
            1246,
            1261,
            1262,
            1274,
            1286,
            1287,
            1290,
            1291,
            1294,
            1296,
            1298,
            1300,
            1301,
            1312,
            1324,
            1326,
            1329,
            1338,
            1339,
            1340,
            1343,
            1351,
            1359,
            1362,
            1363,
            1368,
            1372,
            1378,
            1381,
            1396,
            1398,
            1400,
            1408,
            1416,
            1417,
            1419,
            1424,
            1428,
            1429,
            1435,
            1437,
            1439,
            1455,
            1458,
            1461,
            1469,
            1477,
            1480,
            1482,
            1502,
            1503,
            1509,
            1514,
            1523,
            1527,
            1528,
            1534,
            1537,
            1540,
            1544,
            1555,
            1560,
            1562,
            1574,
            1585,
            1591,
            1593,
            1606,
            1607,
            1610,
            1613,
            1614,
            1618,
            1620,
            1621,
            1625,
            1626,
            1627,
            1633,
            1637,
            1639,
            1643,
            1653,
            1654,
            1657,
            1658,
            1667,
            1669,
            1670,
            1676,
            1679,
            1683,
            1686,
            1687,
            1692,
            1700,
            1709,
            1715,
            1718,
            1721,
            1734,
            1739,
            1743,
            1753,
            1757,
            1764,
            1765,
            1779,
            1781,
            1789,
            1799,
            1800,
            1801,
            1802,
            1803,
            1805,
            1806,
            1814,
            1815,
            1821,
            1831,
            1835,
            1840,
            1846,
            1847,
            1862,
            1863,
            1872,
            1874,
            1877,
            1878,
            1882,
            1885,
            1895,
            1896,
            1901,
            1902,
            1904,
            1906,
            1908,
            1912,
            1913,
            1914,
            1915,
            1923,
            1928,
            1929,
            1930,
            1934,
            1935,
            1938,
            1939,
            1951,
            1961,
            1964,
            1973,
            1975,
            1979,
            1984,
            1986,
            1988,
            1989,
            1996,
            1999,
            2034,
            2050,
            2054,
            2055,
            2058,
            2066,
            2071,
            2073,
            2074,
            2092,
            2102,
            2106,
            2113,
            2114,
            2128,
            2136,
            2140,
            2148,
            2168,
            2174,
            2179,
            2186,
            2194,
            2197,
            2201,
            2214,
            2218,
            2222,
            2224,
            2226,
            2230,
            2234,
            2246,
            2251,
            2254,
            2259,
            2262,
            2266,
            2271,
            2276,
            2282
          ]
        }
      ],
      "summary": {
        "total_devices": 2292,
        "active_devices": 1923,
        "trusted_devices": 1730,
        "untrusted_active_devices": 463,
        "trust_rate": 75.48
      },
      "failed_rows": {
        "customer_device": [
          8,
          11,
          15,
          17,
          27,
          35,
          37,
          40,
          43,
          46,
          47,
          52,
          53,
          57,
          66,
          68,
          84,
          85,
          87,
          92,
          115,
          121,
          123,
          125,
          130,
          133,
          145,
          148,
          149,
          150,
          159,
          167,
          172,
          175,
          176,
          184,
          190,
          200,
          201,
          208,
          210,
          226,
          228,
          229,
          231,
          247,
          261,
          262,
          266,
          267,
          293,
          297,
          314,
          315,
          317,
          335,
          339,
          343,
          350,
          353,
          359,
          364,
          369,
          371,
          373,
          395,
          401,
          407,
          410,
          411,
          412,
          413,
          425,
          431,
          432,
          435,
          445,
          447,
          448,
          451,
          453,
          464,
          466,
          469,
          478,
          483,
          484,
          486,
          488,
          491,
          498,
          502,
          504,
          505,
          520,
          525,
          540,
          542,
          544,
          549,
          562,
          565,
          567,
          572,
          577,
          585,
          587,
          589,
          592,
          594,
          598,
          606,
          607,
          609,
          612,
          615,
          628,
          629,
          631,
          632,
          636,
          640,
          641,
          649,
          661,
          666,
          675,
          689,
          692,
          693,
          696,
          704,
          713,
          728,
          730,
          733,
          734,
          737,
          741,
          742,
          744,
          745,
          746,
          750,
          752,
          775,
          778,
          785,
          788,
          792,
          794,
          800,
          802,
          809,
          818,
          819,
          821,
          827,
          828,
          839,
          843,
          845,
          850,
          865,
          871,
          875,
          879,
          880,
          889,
          892,
          901,
          904,
          905,
          908,
          911,
          919,
          921,
          926,
          930,
          931,
          936,
          942,
          943,
          949,
          958,
          959,
          963,
          968,
          972,
          980,
          988,
          994,
          995,
          997,
          1004,
          1005,
          1006,
          1010,
          1013,
          1014,
          1023,
          1024,
          1030,
          1032,
          1033,
          1036,
          1037,
          1041,
          1043,
          1050,
          1052,
          1056,
          1079,
          1083,
          1085,
          1089,
          1090,
          1092,
          1094,
          1095,
          1104,
          1109,
          1110,
          1111,
          1116,
          1118,
          1120,
          1124,
          1125,
          1134,
          1135,
          1136,
          1144,
          1147,
          1148,
          1149,
          1157,
          1165,
          1169,
          1176,
          1184,
          1185,
          1190,
          1191,
          1192,
          1194,
          1198,
          1207,
          1208,
          1214,
          1219,
          1220,
          1228,
          1235,
          1236,
          1239,
          1244,
          1245,
          1246,
          1261,
          1262,
          1274,
          1286,
          1287,
          1290,
          1291,
          1294,
          1296,
          1298,
          1300,
          1301,
          1312,
          1324,
          1326,
          1329,
          1338,
          1339,
          1340,
          1343,
          1351,
          1359,
          1362,
          1363,
          1368,
          1372,
          1378,
          1381,
          1396,
          1398,
          1400,
          1408,
          1416,
          1417,
          1419,
          1424,
          1428,
          1429,
          1435,
          1437,
          1439,
          1455,
          1458,
          1461,
          1469,
          1477,
          1480,
          1482,
          1502,
          1503,
          1509,
          1514,
          1523,
          1527,
          1528,
          1534,
          1537,
          1540,
          1544,
          1555,
          1560,
          1562,
          1574,
          1585,
          1591,
          1593,
          1606,
          1607,
          1610,
          1613,
          1614,
          1618,
          1620,
          1621,
          1625,
          1626,
          1627,
          1633,
          1637,
          1639,
          1643,
          1653,
          1654,
          1657,
          1658,
          1667,
          1669,
          1670,
          1676,
          1679,
          1683,
          1686,
          1687,
          1692,
          1700,
          1709,
          1715,
          1718,
          1721,
          1734,
          1739,
          1743,
          1753,
          1757,
          1764,
          1765,
          1779,
          1781,
          1789,
          1799,
          1800,
          1801,
          1802,
          1803,
          1805,
          1806,
          1814,
          1815,
          1821,
          1831,
          1835,
          1840,
          1846,
          1847,
          1862,
          1863,
          1872,
          1874,
          1877,
          1878,
          1882,
          1885,
          1895,
          1896,
          1901,
          1902,
          1904,
          1906,
          1908,
          1912,
          1913,
          1914,
          1915,
          1923,
          1928,
          1929,
          1930,
          1934,
          1935,
          1938,
          1939,
          1951,
          1961,
          1964,
          1973,
          1975,
          1979,
          1984,
          1986,
          1988,
          1989,
          1996,
          1999,
          2034,
          2050,
          2054,
          2055,
          2058,
          2066,
          2071,
          2073,
          2074,
          2092,
          2102,
          2106,
          2113,
          2114,
          2128,
          2136,
          2140,
          2148,
          2168,
          2174,
          2179,
          2186,
          2194,
          2197,
          2201,
          2214,
          2218,
          2222,
          2224,
          2226,
          2230,
          2234,
          2246,
          2251,
          2254,
          2259,
          2262,
          2266,
          2271,
          2276,
          2282
        ]
      },
      "requirement": "Device must be verified if new or untrusted - Active devices must be trusted/verified"
    },
    "daily_transaction_limit_auth": {
      "check_type": "daily_transaction_limit_auth",
      "status": "FAIL",
      "issues": [
        {
          "rule": "Daily transactions >= 20M VND must have at least one strong authentication (PIN_OTP or PIN_OTP_Biometric)",
          "violation_count": 11,
          "total_high_daily_volume_cases": 4128,
          "violation_percentage": 0.27,
          "sample_violations": [
            {
              "customer_id": "041761da-0aae-452e-97ca-0bf6c8eda73f",
              "transaction_date": "2025-07-06",
              "total_amount": 24790000.0,
              "transaction_count": 3,
              "auth_methods_used": [
                "PIN"
              ]
            },
            {
              "customer_id": "0424e077-47dc-4035-83e3-99fb76f7e81b",
              "transaction_date": "2025-07-10",
              "total_amount": 24620000.0,
              "transaction_count": 3,
              "auth_methods_used": [
                "PIN"
              ]
            },
            {
              "customer_id": "044bdbc4-a26c-43d6-91e6-d825f60e173c",
              "transaction_date": "2025-07-03",
              "total_amount": 22610000.0,
              "transaction_count": 4,
              "auth_methods_used": [
                "PIN"
              ]
            },
            {
              "customer_id": "123952e0-ff9f-4175-a41d-397802aa21f5",
              "transaction_date": "2025-06-24",
              "total_amount": 24540000.0,
              "transaction_count": 4,
              "auth_methods_used": [
                "PIN"
              ]
            },
            {
              "customer_id": "34dafbe1-c906-4538-b151-a88c4d0aa8ec",
              "transaction_date": "2025-07-15",
              "total_amount": 20170000.0,
              "transaction_count": 3,
              "auth_methods_used": [
                "PIN"
              ]
            }
          ]
        }
      ],
      "summary": {
        "total_customer_days_analyzed": 33805,
        "high_volume_days": 4128,
        "violation_days": 11,
        "compliance_rate": 99.73
      },
      "failed_rows": {},
      "requirement": "Total transaction amount per customer more than 20M VND in a day must have at least one strong auth method - per 2345/QĐ-NHNN 2023"
    },
    "transaction_type_constraints": {
      "check_type": "transaction_type_constraints",
      "status": "PASS",
      "issues": [],
      "summary": {
        "total_transactions": 70321,
        "internal_transfers": 31759,
        "external_transfers": 24710,
        "bill_payments": 13852,
        "constraint_violations": 0
      },
      "failed_rows": {},
      "requirement": "Transaction type constraints - Transaction-specific field requirements must be satisfied based on transaction type"
    }
  },
  "cleaning_summary": {
    "customer": {
      "original_count": 1998,
      "removed_count": 371,
      "final_count": 1627,
      "cleaned_percentage": 81.43,
      "final_count_after_fk_cleanup": 1627,
      "total_removed": 371,
      "final_cleaned_percentage": 81.43
    },
    "customer_device": {
      "original_count": 2292,
      "removed_count": 463,
      "final_count": 1829,
      "cleaned_percentage": 79.8,
      "final_count_after_fk_cleanup": 1507,
      "total_removed": 785,
      "final_cleaned_percentage": 65.75
    },
    "authentication_log": {
      "original_count": 96091,
      "removed_count": 0,
      "final_count": 96091,
      "cleaned_percentage": 100.0,
      "final_count_after_fk_cleanup": 64597,
      "total_removed": 31494,
      "final_cleaned_percentage": 67.22
    },
    "bank_account": {
      "original_count": 2371,
      "removed_count": 0,
      "final_count": 2371,
      "cleaned_percentage": 100.0,
      "final_count_after_fk_cleanup": 1944,
      "total_removed": 427,
      "final_cleaned_percentage": 81.99
    },
    "face_template": {
      "original_count": 1701,
      "removed_count": 0,
      "final_count": 1701,
      "cleaned_percentage": 100.0,
      "final_count_after_fk_cleanup": 1393,
      "total_removed": 308,
      "final_cleaned_percentage": 81.89
    },
    "transaction": {
      "original_count": 70321,
      "removed_count": 0,
      "final_count": 70321,
      "cleaned_percentage": 100.0,
      "final_count_after_fk_cleanup": 57915,
      "total_removed": 12406,
      "final_cleaned_percentage": 82.36
    }
  },
  "failed_rows_aggregated": {
    "customer": [
      2,
      4,
      6,
      8,
      14,
      33,
      39,
      40,
      41,
      43,
      44,
      52,
      55,
      57,
      58,
      70,
      76,
      83,
      84,
      94,
      101,
      109,
      115,
      127,
      131,
      132,
      136,
      145,
      151,
      156,
      159,
      165,
      168,
      169,
      172,
      174,
      180,
      181,
      184,
      188,
      191,
      193,
      195,
      214,
      215,
      219,
      220,
      233,
      235,
      239,
      245,
      249,
      252,
      254,
      255,
      256,
      262,
      275,
      281,
      282,
      284,
      286,
      287,
      289,
      291,
      295,
      304,
      308,
      312,
      315,
      316,
      317,
      347,
      350,
      351,
      353,
      354,
      366,
      372,
      374,
      377,
      389,
      398,
      419,
      426,
      432,
      449,
      452,
      458,
      469,
      480,
      482,
      489,
      508,
      510,
      520,
      522,
      527,
      530,
      541,
      542,
      563,
      577,
      585,
      586,
      594,
      604,
      605,
      609,
      613,
      622,
      624,
      626,
      646,
      664,
      673,
      682,
      683,
      689,
      707,
      709,
      715,
      718,
      721,
      725,
      731,
      733,
      734,
      742,
      749,
      758,
      760,
      766,
      770,
      772,
      774,
      777,
      778,
      781,
      785,
      787,
      788,
      795,
      796,
      802,
      807,
      809,
      815,
      816,
      825,
      830,
      833,
      844,
      850,
      852,
      860,
      871,
      873,
      881,
      884,
      885,
      892,
      893,
      895,
      906,
      907,
      914,
      918,
      919,
      930,
      932,
      937,
      966,
      967,
      970,
      984,
      993,
      997,
      1000,
      1001,
      1002,
      1004,
      1005,
      1007,
      1015,
      1020,
      1025,
      1028,
      1033,
      1035,
      1038,
      1043,
      1049,
      1050,
      1063,
      1065,
      1075,
      1079,
      1083,
      1085,
      1092,
      1095,
      1099,
      1100,
      1103,
      1106,
      1110,
      1112,
      1117,
      1122,
      1124,
      1136,
      1145,
      1149,
      1152,
      1156,
      1157,
      1160,
      1174,
      1176,
      1177,
      1190,
      1198,
      1206,
      1210,
      1217,
      1218,
      1226,
      1227,
      1231,
      1236,
      1238,
      1242,
      1249,
      1252,
      1254,
      1256,
      1270,
      1273,
      1276,
      1277,
      1283,
      1297,
      1317,
      1319,
      1320,
      1323,
      1327,
      1329,
      1330,
      1332,
      1336,
      1337,
      1342,
      1344,
      1347,
      1351,
      1353,
      1356,
      1359,
      1365,
      1366,
      1388,
      1392,
      1393,
      1413,
      1415,
      1417,
      1425,
      1428,
      1432,
      1441,
      1442,
      1443,
      1452,
      1458,
      1459,
      1469,
      1472,
      1473,
      1478,
      1480,
      1483,
      1488,
      1489,
      1505,
      1510,
      1517,
      1524,
      1529,
      1533,
      1566,
      1577,
      1587,
      1593,
      1596,
      1599,
      1601,
      1602,
      1606,
      1611,
      1612,
      1626,
      1633,
      1635,
      1645,
      1653,
      1654,
      1656,
      1658,
      1664,
      1673,
      1686,
      1690,
      1691,
      1692,
      1695,
      1697,
      1698,
      1699,
      1704,
      1713,
      1714,
      1721,
      1725,
      1727,
      1737,
      1741,
      1751,
      1756,
      1762,
      1770,
      1774,
      1791,
      1792,
      1804,
      1808,
      1815,
      1816,
      1819,
      1821,
      1823,
      1824,
      1825,
      1836,
      1839,
      1859,
      1861,
      1875,
      1878,
      1886,
      1892,
      1902,
      1904,
      1915,
      1921,
      1923,
      1924,
      1928,
      1933,
      1936,
      1941,
      1955,
      1957,
      1968,
      1974,
      1975,
      1977,
      1980,
      1984,
      1988
    ],
    "customer_device": [
      8,
      11,
      15,
      17,
      27,
      35,
      37,
      40,
      43,
      46,
      47,
      52,
      53,
      57,
      66,
      68,
      84,
      85,
      87,
      92,
      115,
      121,
      123,
      125,
      130,
      133,
      145,
      148,
      149,
      150,
      159,
      167,
      172,
      175,
      176,
      184,
      190,
      200,
      201,
      208,
      210,
      226,
      228,
      229,
      231,
      247,
      261,
      262,
      266,
      267,
      293,
      297,
      314,
      315,
      317,
      335,
      339,
      343,
      350,
      353,
      359,
      364,
      369,
      371,
      373,
      395,
      401,
      407,
      410,
      411,
      412,
      413,
      425,
      431,
      432,
      435,
      445,
      447,
      448,
      451,
      453,
      464,
      466,
      469,
      478,
      483,
      484,
      486,
      488,
      491,
      498,
      502,
      504,
      505,
      520,
      525,
      540,
      542,
      544,
      549,
      562,
      565,
      567,
      572,
      577,
      585,
      587,
      589,
      592,
      594,
      598,
      606,
      607,
      609,
      612,
      615,
      628,
      629,
      631,
      632,
      636,
      640,
      641,
      649,
      661,
      666,
      675,
      689,
      692,
      693,
      696,
      704,
      713,
      728,
      730,
      733,
      734,
      737,
      741,
      742,
      744,
      745,
      746,
      750,
      752,
      775,
      778,
      785,
      788,
      792,
      794,
      800,
      802,
      809,
      818,
      819,
      821,
      827,
      828,
      839,
      843,
      845,
      850,
      865,
      871,
      875,
      879,
      880,
      889,
      892,
      901,
      904,
      905,
      908,
      911,
      919,
      921,
      926,
      930,
      931,
      936,
      942,
      943,
      949,
      958,
      959,
      963,
      968,
      972,
      980,
      988,
      994,
      995,
      997,
      1004,
      1005,
      1006,
      1010,
      1013,
      1014,
      1023,
      1024,
      1030,
      1032,
      1033,
      1036,
      1037,
      1041,
      1043,
      1050,
      1052,
      1056,
      1079,
      1083,
      1085,
      1089,
      1090,
      1092,
      1094,
      1095,
      1104,
      1109,
      1110,
      1111,
      1116,
      1118,
      1120,
      1124,
      1125,
      1134,
      1135,
      1136,
      1144,
      1147,
      1148,
      1149,
      1157,
      1165,
      1169,
      1176,
      1184,
      1185,
      1190,
      1191,
      1192,
      1194,
      1198,
      1207,
      1208,
      1214,
      1219,
      1220,
      1228,
      1235,
      1236,
      1239,
      1244,
      1245,
      1246,
      1261,
      1262,
      1274,
      1286,
      1287,
      1290,
      1291,
      1294,
      1296,
      1298,
      1300,
      1301,
      1312,
      1324,
      1326,
      1329,
      1338,
      1339,
      1340,
      1343,
      1351,
      1359,
      1362,
      1363,
      1368,
      1372,
      1378,
      1381,
      1396,
      1398,
      1400,
      1408,
      1416,
      1417,
      1419,
      1424,
      1428,
      1429,
      1435,
      1437,
      1439,
      1455,
      1458,
      1461,
      1469,
      1477,
      1480,
      1482,
      1502,
      1503,
      1509,
      1514,
      1523,
      1527,
      1528,
      1534,
      1537,
      1540,
      1544,
      1555,
      1560,
      1562,
      1574,
      1585,
      1591,
      1593,
      1606,
      1607,
      1610,
      1613,
      1614,
      1618,
      1620,
      1621,
      1625,
      1626,
      1627,
      1633,
      1637,
      1639,
      1643,
      1653,
      1654,
      1657,
      1658,
      1667,
      1669,
      1670,
      1676,
      1679,
      1683,
      1686,
      1687,
      1692,
      1700,
      1709,
      1715,
      1718,
      1721,
      1734,
      1739,
      1743,
      1753,
      1757,
      1764,
      1765,
      1779,
      1781,
      1789,
      1799,
      1800,
      1801,
      1802,
      1803,
      1805,
      1806,
      1814,
      1815,
      1821,
      1831,
      1835,
      1840,
      1846,
      1847,
      1862,
      1863,
      1872,
      1874,
      1877,
      1878,
      1882,
      1885,
      1895,
      1896,
      1901,
      1902,
      1904,
      1906,
      1908,
      1912,
      1913,
      1914,
      1915,
      1923,
      1928,
      1929,
      1930,
      1934,
      1935,
      1938,
      1939,
      1951,
      1961,
      1964,
      1973,
      1975,
      1979,
      1984,
      1986,
      1988,
      1989,
      1996,
      1999,
      2034,
      2050,
      2054,
      2055,
      2058,
      2066,
      2071,
      2073,
      2074,
      2092,
      2102,
      2106,
      2113,
      2114,
      2128,
      2136,
      2140,
      2148,
      2168,
      2174,
      2179,
      2186,
      2194,
      2197,
      2201,
      2214,
      2218,
      2222,
      2224,
      2226,
      2230,
      2234,
      2246,
      2251,
      2254,
      2259,
      2262,
      2266,
      2271,
      2276,
      2282
    ]
  }
}